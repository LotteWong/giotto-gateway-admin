(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-73ba9690"],{"22ce":function(e,t,l){"use strict";l.d(t,"f",(function(){return a})),l.d(t,"b",(function(){return r})),l.d(t,"c",(function(){return s})),l.d(t,"a",(function(){return o})),l.d(t,"g",(function(){return n})),l.d(t,"i",(function(){return c})),l.d(t,"j",(function(){return m})),l.d(t,"h",(function(){return _})),l.d(t,"d",(function(){return u})),l.d(t,"e",(function(){return p}));var i=l("b775");function a(e){return Object(i["a"])({url:"/services",method:"get",params:e})}function r(e){return Object(i["a"])({url:"/services/http",method:"post",data:e})}function s(e){return Object(i["a"])({url:"/services/tcp",method:"post",data:e})}function o(e){return Object(i["a"])({url:"/services/grpc",method:"post",data:e})}function n(e){return Object(i["a"])({url:"/services/"+e,method:"get"})}function c(e,t){return Object(i["a"])({url:"/services/http/"+e,method:"put",data:t})}function m(e,t){return Object(i["a"])({url:"/services/tcp/"+e,method:"put",data:t})}function _(e,t){return Object(i["a"])({url:"/services/grpc/"+e,method:"put",data:t})}function u(e){return Object(i["a"])({url:"/services/"+e,method:"delete"})}function p(e){return Object(i["a"])({url:"/dashboard/flow/services/"+e,method:"get"})}},"39d5":function(e,t,l){},7207:function(e,t,l){"use strict";l.r(t);var i=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"mixin-components-container"},[l("el-row",[l("el-card",{staticClass:"box-card"},[l("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e.isEdit?e._e():l("span",[e._v("Create Http Service")]),e.isEdit?l("span",[e._v("Update Http Service")]):e._e()]),l("div",{staticStyle:{"margin-bottom":"50px"}},[l("el-form",{ref:"form",attrs:{model:e.form}},[l("el-collapse",{model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[l("el-collapse-item",{attrs:{title:"服务简要信息/Service Info",name:"1"}},[l("el-form-item",{attrs:{label:"Service Name",required:!0,"label-width":"200px"}},[l("el-input",{attrs:{disabled:e.isEdit,placeholder:"Please input service name"},model:{value:e.form.service_name,callback:function(t){e.$set(e.form,"service_name",t)},expression:"form.service_name"}})],1),l("el-form-item",{attrs:{label:"Service Desc","label-width":"200px"}},[l("el-input",{attrs:{placeholder:"Please input service description"},model:{value:e.form.service_desc,callback:function(t){e.$set(e.form,"service_desc",t)},expression:"form.service_desc"}})],1)],1),l("el-collapse-item",{attrs:{title:"协议接入配置/Protocol Rule",name:"2"}},[l("el-form-item",{attrs:{label:"Rule",required:!0,"label-width":"200px"}},[l("el-input",{staticClass:"input-with-select",attrs:{placeholder:"Please input rule",disabled:e.isEdit},model:{value:e.form.rule,callback:function(t){e.$set(e.form,"rule",t)},expression:"form.rule"}},[l("el-select",{staticStyle:{width:"100px"},attrs:{slot:"prepend",placeholder:"Please select rule type",disabled:e.isEdit},slot:"prepend",model:{value:e.form.rule_type,callback:function(t){e.$set(e.form,"rule_type",t)},expression:"form.rule_type"}},[l("el-option",{attrs:{label:"Prefix",value:0}}),l("el-option",{attrs:{label:"Domain",value:1}})],1)],1)],1),l("el-form-item",{attrs:{label:"Enable Https","label-width":"200px"}},[l("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:e.form.need_https,callback:function(t){e.$set(e.form,"need_https",t)},expression:"form.need_https"}}),l("span",{staticStyle:{color:"#606266","font-weight":"700","margin-left":"50px"}},[e._v(" Enable WebSocket ")]),l("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:e.form.need_websocket,callback:function(t){e.$set(e.form,"need_websocket",t)},expression:"form.need_websocket"}})],1),l("el-form-item",{attrs:{label:"Url Rewrite","label-width":"200px"}},[l("el-input",{attrs:{type:"textarea",placeholder:"Please input url rewrite",autosize:""},model:{value:e.form.url_rewrite,callback:function(t){e.$set(e.form,"url_rewrite",t)},expression:"form.url_rewrite"}})],1),l("el-form-item",{attrs:{label:"Header Transform","label-width":"200px"}},[l("el-input",{attrs:{type:"textarea",placeholder:"Please input header transform",autosize:""},model:{value:e.form.header_transform,callback:function(t){e.$set(e.form,"header_transform",t)},expression:"form.header_transform"}})],1),l("el-form-item",{attrs:{label:"Strip Uri","label-width":"200px"}},[l("el-switch",{attrs:{"active-text":"Yes","inactive-text":"No","active-value":1,"inactive-value":0},model:{value:e.form.need_strip_uri,callback:function(t){e.$set(e.form,"need_strip_uri",t)},expression:"form.need_strip_uri"}})],1)],1),l("el-collapse-item",{attrs:{title:"权限认证配置/Ip Auth",name:"3"}},[l("el-form-item",{attrs:{label:"Enable Auth","label-width":"200px"}},[l("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:e.form.open_auth,callback:function(t){e.$set(e.form,"open_auth",t)},expression:"form.open_auth"}})],1),l("el-form-item",{attrs:{label:"Ip White List","label-width":"200px"}},[l("el-input",{attrs:{type:"textarea",placeholder:"Please input ip white list",autosize:""},model:{value:e.form.white_list,callback:function(t){e.$set(e.form,"white_list",t)},expression:"form.white_list"}})],1),l("el-form-item",{attrs:{label:"Ip Black List","label-width":"200px"}},[l("el-input",{attrs:{type:"textarea",placeholder:"Please input ip black list",autosize:""},model:{value:e.form.black_list,callback:function(t){e.$set(e.form,"black_list",t)},expression:"form.black_list"}})],1)],1),l("el-collapse-item",{attrs:{title:"流量控制配置/Rate Limit",name:"4"}},[l("el-form-item",{attrs:{label:"Service Host Flow Limit","label-width":"200px"}},[l("el-input",{attrs:{placeholder:"Please input service host flow limit"},model:{value:e.form.service_host_flow_limit,callback:function(t){e.$set(e.form,"service_host_flow_limit",e._n(t))},expression:"form.service_host_flow_limit"}})],1),l("el-form-item",{attrs:{label:"Service Host Flow Interval","label-width":"200px"}},[l("el-input",{attrs:{placeholder:"Please input service host flow interval"},model:{value:e.form.service_host_flow_interval,callback:function(t){e.$set(e.form,"service_host_flow_interval",e._n(t))},expression:"form.service_host_flow_interval"}})],1),l("el-form-item",{attrs:{label:"Client Ip Flow Limit","label-width":"200px"}},[l("el-input",{attrs:{placeholder:"Please input client ip flow limit"},model:{value:e.form.client_ip_flow_limit,callback:function(t){e.$set(e.form,"client_ip_flow_limit",e._n(t))},expression:"form.client_ip_flow_limit"}})],1),l("el-form-item",{attrs:{label:"Client Ip Flow Interval","label-width":"200px"}},[l("el-input",{attrs:{placeholder:"Please input client ip flow interval"},model:{value:e.form.client_ip_flow_interval,callback:function(t){e.$set(e.form,"client_ip_flow_interval",e._n(t))},expression:"form.client_ip_flow_interval"}})],1)],1),l("el-collapse-item",{attrs:{title:"负载均衡配置/Load Balance",name:"5"}},[l("el-form-item",{attrs:{label:"Round Type",required:!0,"label-width":"200px"}},[l("el-radio-group",{model:{value:e.form.round_type,callback:function(t){e.$set(e.form,"round_type",t)},expression:"form.round_type"}},[l("el-radio",{attrs:{label:0}},[e._v("random")]),l("el-radio",{attrs:{label:1}},[e._v("round robin")]),l("el-radio",{attrs:{label:2}},[e._v("weight round robin")]),l("el-radio",{attrs:{label:3}},[e._v("consistent hash")])],1)],1),l("el-form-item",{attrs:{label:"Ip List","label-width":"200px"}},[l("el-input",{attrs:{type:"textarea",placeholder:"Please input ip list",autosize:""},model:{value:e.form.ip_list,callback:function(t){e.$set(e.form,"ip_list",t)},expression:"form.ip_list"}})],1),l("el-form-item",{attrs:{label:"Weight List","label-width":"200px"}},[l("el-input",{attrs:{type:"textarea",placeholder:"Please input weight list",autosize:""},model:{value:e.form.weight_list,callback:function(t){e.$set(e.form,"weight_list",t)},expression:"form.weight_list"}})],1)],1),l("el-collapse-item",{attrs:{title:"反向代理配置/Reverse Proxy",name:"6"}},[l("el-form-item",{attrs:{label:"Upstream Connect Timeout","label-width":"200px"}},[l("el-input",{attrs:{placeholder:"Please input upstream connect timeout"},model:{value:e.form.upstream_connect_timeout,callback:function(t){e.$set(e.form,"upstream_connect_timeout",e._n(t))},expression:"form.upstream_connect_timeout"}})],1),l("el-form-item",{attrs:{label:"Upstream Header Timeout","label-width":"200px"}},[l("el-input",{attrs:{placeholder:"Please input upstream header timeout"},model:{value:e.form.upstream_header_timeout,callback:function(t){e.$set(e.form,"upstream_header_timeout",e._n(t))},expression:"form.upstream_header_timeout"}})],1),l("el-form-item",{attrs:{label:"Upstream Idle Timeout","label-width":"200px"}},[l("el-input",{attrs:{placeholder:"Please input upstream idle timeout"},model:{value:e.form.upstream_idle_timeout,callback:function(t){e.$set(e.form,"upstream_idle_timeout",e._n(t))},expression:"form.upstream_idle_timeout"}})],1),l("el-form-item",{attrs:{label:"Upstream Max Idle","label-width":"200px"}},[l("el-input",{attrs:{placeholder:"Please input upstream max idle"},model:{value:e.form.upstream_max_idle,callback:function(t){e.$set(e.form,"upstream_max_idle",e._n(t))},expression:"form.upstream_max_idle"}})],1)],1)],1),l("el-form-item",{staticStyle:{"margin-top":"30px","text-align":"center"}},[l("el-button",{attrs:{type:"primary",disabled:e.isSubmit},on:{click:e.handleSubmit}},[e._v("Submit")]),l("el-button",{attrs:{type:"danger",disabled:e.isCancel},on:{click:e.handleCancel}},[e._v("Cancel")])],1)],1)],1)])],1)],1)},a=[],r=(l("ac1f"),l("5319"),l("22ce")),s={name:"HttpService",data:function(){return{isEdit:!1,isSubmit:!1,isCancel:!1,activeNames:["1","2","3","4","5","6"],service_id:0,form:{black_list:"",client_ip_flow_limit:"",client_ip_flow_interval:"",header_transform:"",ip_list:"",need_https:0,need_strip_uri:0,need_websocket:0,open_auth:1,round_type:0,rule:"",rule_type:0,service_desc:"",service_host_flow_limit:"",service_host_flow_interval:"",service_name:"",upstream_connect_timeout:"",upstream_header_timeout:"",upstream_idle_timeout:"",upstream_max_idle:"",url_rewrite:"",weight_list:"",white_list:""}}},created:function(){var e=this.$route.params&&this.$route.params.id;e>0&&(this.isEdit=!0,this.service_id=e,this.fetchFormData(e))},methods:{fetchFormData:function(e){var t=this;Object(r["g"])(e).then((function(e){t.form.black_list=e.data.access_control.black_list.replace(/,/g,"\n"),t.form.client_ip_flow_limit=e.data.access_control.client_ip_flow_limit,t.form.client_ip_flow_interval=e.data.access_control.client_ip_flow_interval,t.form.header_transform=e.data.http_rule.header_transform.replace(/,/g,"\n"),t.form.ip_list=e.data.load_balance.ip_list.replace(/,/g,"\n"),t.form.need_https=e.data.http_rule.need_https,t.form.need_strip_uri=e.data.http_rule.need_strip_uri,t.form.need_websocket=e.data.http_rule.need_websocket,t.form.open_auth=e.data.access_control.open_auth,t.form.round_type=e.data.load_balance.round_type,t.form.rule=e.data.http_rule.rule,t.form.rule_type=e.data.http_rule.rule_type,t.form.service_desc=e.data.info.service_desc,t.form.service_host_flow_limit=e.data.access_control.service_host_flow_limit,t.form.service_host_flow_interval=e.data.access_control.service_host_flow_interval,t.form.service_name=e.data.info.service_name,t.form.upstream_connect_timeout=e.data.load_balance.upstream_connect_timeout,t.form.upstream_header_timeout=e.data.load_balance.upstream_header_timeout,t.form.upstream_idle_timeout=e.data.load_balance.upstream_idle_timeout,t.form.upstream_max_idle=e.data.load_balance.upstream_max_idle,t.form.url_rewrite=e.data.http_rule.url_rewrite.replace(/,/g,"\n"),t.form.weight_list=e.data.load_balance.weight_list.replace(/,/g,"\n"),t.form.white_list=e.data.access_control.white_list.replace(/,/g,"\n")}))},handleSubmit:function(){var e=this;this.isSubmit=!0;var t=Object.assign({},this.form);t.url_rewrite=t.url_rewrite.replace(/\n/g,","),t.header_transform=t.header_transform.replace(/\n/g,","),t.white_list=t.white_list.replace(/\n/g,","),t.black_list=t.black_list.replace(/\n/g,","),t.ip_list=t.ip_list.replace(/\n/g,","),t.weight_list=t.weight_list.replace(/\n/g,","),t.service_host_flow_limit=""===t.service_host_flow_limit?0:t.service_host_flow_limit,t.service_host_flow_interval=""===t.service_host_flow_interval?0:t.service_host_flow_interval,t.client_ip_flow_limit=""===t.client_ip_flow_limit?0:t.client_ip_flow_limit,t.client_ip_flow_interval=""===t.client_ip_flow_interval?0:t.client_ip_flow_interval,t.upstream_connect_timeout=""===t.upstream_connect_timeout?0:t.upstream_connect_timeout,t.upstream_header_timeout=""===t.upstream_header_timeout?0:t.upstream_header_timeout,t.upstream_idle_timeout=""===t.upstream_idle_timeout?0:t.upstream_idle_timeout,t.upstream_max_idle=""===t.upstream_max_idle?0:t.upstream_max_idle,console.log(t),this.isEdit?Object(r["i"])(this.service_id,t).then((function(t){e.isSubmit=!1,e.fetchFormData(e.service_id),e.$notify({title:"Success",message:"Update Successfully",type:"success",duration:2e3})})).catch((function(){e.isSubmit=!1})):Object(r["b"])(t).then((function(t){e.isSubmit=!1,e.resetFormData(),e.$notify({title:"Success",message:"Create Successfully",type:"success",duration:2e3})})).catch((function(){e.isSubmit=!1}))},handleCancel:function(){this.isCancel=!0,this.resetFormData(),this.isCancel=!1},resetFormData:function(){this.form={black_list:"",client_ip_flow_limit:"",client_ip_flow_interval:"",header_transform:"",ip_list:"",need_https:0,need_strip_uri:0,need_websocket:0,open_auth:1,round_type:0,rule:"",rule_type:0,service_desc:"",service_host_flow_limit:"",service_host_flow_interval:"",service_name:"",upstream_connect_timeout:"",upstream_header_timeout:"",upstream_idle_timeout:"",upstream_max_idle:"",url_rewrite:"",weight_list:"",white_list:""}}}},o=s,n=(l("db87"),l("0c7c")),c=Object(n["a"])(o,i,a,!1,null,"59140bea",null);t["default"]=c.exports},db87:function(e,t,l){"use strict";l("39d5")}}]);